<html>
<head>
    <style>
        table {
            border: solid 1px black;
            border-collapse: collapse;
            width: 80% !important;
        }

        th {
            padding: 5px;
        }

        .header {
            background-color: #bfbfbf;
            color: black;
        }

        .header-text {
            text-align: center;
        }

        .row-border td {
            border-bottom: 1px solid black;
            text-align: center;
        }

        .all-border td {
            border: solid 1px black;
            text-align: center;
        }

        .text-green {
            color: green;
        }

        .text-red {
            color: red;
        }
    </style>
</head>
<body>
{% for report in all_reports %}
<h3>{{ report.lineage }}</h3>
<b>Chart name: </b>{{ report.chart_name }}<br>
<b>Link to chart: </b><a href="{{ report.url }}" target="_blank">Link</a><br>
<b>Bugs: </b>
{% for jira_id in report.jira_ids %}
<a href="{{ 'http://jira/browse/' + jira_id }}" target="_blank">{{ jira_id }}</a>
{% endfor %}<br>
<b>Comments: </b>{{ report.comments }}
<br>
<table>
    <tr class="header">
        <th class="header-text" rowspan="2">Series name</th>
        <th class="header-text" rowspan="2">Unit</th>
        <th class="header-text" rowspan="2">Yesterday <br><span style="font-size: smaller">{{
            report.report[0].yesterdayDate }}</span></th>
        <th class="header-text" rowspan="2">Today <br><span style="font-size: smaller">{{
            report.report[0].todayDate }}</span></th>
        <th class="header-text" rowspan="2">Percentage change</th>
        <th class="header-text" colspan="2">History</th>
    </tr>
    <tr class="header">
        <th class="header-text">Date</th>
        <th class="header-text">Value</th>
    </tr>
    {% for data_set in report.report %}
    <tr class="row-border">
        <td rowspan="{{ data_set.rows }}">
            {{ data_set.name }}
        </td>
        <td rowspan="{{ data_set.rows }}">
            {{ data_set.unit }}
        </td>
        <td rowspan="{{ data_set.rows }}">
            {{ data_set.yesterday }}
        </td>
        <td rowspan="{{ data_set.rows }}">
            {{ data_set.today }}
        </td>
        {% if (report.positive == true) and ('+' in data_set.percentage) %}
        <td class="text-green" rowspan="{{ data_set.rows }}">
            {{ data_set.percentage }}
        </td>
        {% elif (report.positive == true) and ('-' in data_set.percentage) %}
        <td class="text-red" rowspan="{{ data_set.rows }}">
            {{ data_set.percentage }}
        </td>
        {% elif (report.positive == false) and ('+' in data_set.percentage) %}
        <td class="text-red" rowspan="{{ data_set.rows }}">
            {{ data_set.percentage }}
        </td>
        {% elif (report.positive == false) and ('-' in data_set.percentage) %}
        <td class="text-green" rowspan="{{ data_set.rows }}">
            {{ data_set.percentage }}
        </td>
        {% else %}
        <td rowspan="{{ data_set.rows }}">
            {{ data_set.percentage }}
        </td>
        {% endif %}
    </tr>
    {% for data in data_set.history %}
    <tr class="all-border">
        <td>{{ data.date }}</td>
        <td>{{ data.value }}
            {% if (report.positive == true) and ('+' in data_set.percentage_history) and (loop.index == 1) %}
            <br>
            <span class="text-green">
            {{ data_set.percentage_history }}
        </span>
            {% elif (report.positive == true) and ('-' in data_set.percentage_history) and (loop.index == 1) %}
            <br>
            <span class="text-red">
            {{ data_set.percentage_history }}
        </span>
            {% elif (report.positive == false) and ('+' in data_set.percentage_history) and (loop.index == 1) %}
            <br>
            <span class="text-red">
            {{ data_set.percentage_history }}
        </span>
            {% elif (report.positive == false) and ('-' in data_set.percentage_history) and (loop.index == 1) %}
            <br>
            <span class="text-green">
            {{ data_set.percentage_history }}
        </span>
            {% elif loop.index == 1 %}
            <br>
            <span>
            {{ data_set.percentage_history }}
        </span>
            {% endif %}
        </td>
    </tr>
    {% endfor %}
    {% endfor %}
</table>
<br>
<br>
{% endfor %}
</body>
</html>