<div class="component">

  <form [formGroup]="submissionForm">
    <div class="form-group">
      <label class="control-label col-sm-2" for="submitter">Submitter: </label>
      <select class="form-control" id="submitter" formControlName="submitter">
        <option *ngFor="let user of users" [value]="user.email">{{ user.first_name }} {{ user.last_name }} ({{ user.email }})</option>
      </select>
    </div>

    <div class="form-group">
      <label class="control-label col-sm-2" for="from_fun_os_sha">From FunOS commit: </label>
      <input style="width: 300px" formControlName="from_fun_os_sha" id="from_fun_os_sha">
    </div>

    <div class="form-group">
      <label class="control-label col-sm-2" for="to_fun_os_sha">To FunOS commit: </label>
      <input style="width: 300px" formControlName="to_fun_os_sha" id="to_fun_os_sha">
    </div>

    <div class="form-group">
      <label class="control-label col-sm-2" for="metric_id">Metric ID: </label>
      <input style="width: 300px" formControlName="metric_id" id="metric_id">
    </div>

  </form>
  <app-jenkins-form (data)="jenkinsParametersChanged($event)"></app-jenkins-form>

  <ng-container *ngIf="!gitShasValid">
    <button (click)="validateShas()">Validate commits</button>
  </ng-container>
  <button (click)="onSubmit()" class="btn btn-success" type="submit" [disabled]="!submissionForm.valid || !gitShasValid">Submit</button>

  <div class="card">
    <div class="card-header">
      Triages
    </div>
    <div class="card-body">
      <table class="table table-responsive">
        <tr>
          <th></th>
          <th>Metric ID</th>
          <th>Submitter</th>
          <th>From FunOS sha</th>
          <th>To FunOS sha</th>
          <th>Build parameters</th>
        </tr>
        <tr *ngFor="let triage of triages">
          <td>
            <a href="/triaging/{{ triage.triage_id }}" target="_blank">Details</a>
          </td>
          <td>
            {{ triage.metric_id }}
          </td>
          <td>
            {{ triage.submitter_email }}
          </td>
          <td>
            {{ getShortSha(triage.from_fun_os_sha) }}
          </td>
          <td>
            {{ getShortSha(triage.to_fun_os_sha) }}
          </td>
          <td>
            {{ triage.build_parameters | json }}
          </td>
        </tr>
      </table>
    </div>
  </div>

</div>


