<div *ngIf="showForm" class="card card-primary component">
  <div class="card-header min-padding"><b>Submit info</b></div>
      <table class="table table-borderless" style="width: 50%">
        <!--<tr>-->
          <!--<td>-->
            <!--From Date:-->
            <!--<form class="form-inline">-->
              <!--<div class="form-group">-->
                <!--<div class="input-group">-->
                  <!--<input class="form-control" placeholder="yyyy-mm-dd"-->
                         <!--name="dp1" [(ngModel)]="fromDate" ngbDatepicker #d="ngbDatepicker">-->
                  <!--<div class="input-group-append">-->
                    <!--<button class="btn btn-outline-secondary" (click)="d.toggle()" type="button"><i class="fa fa-calendar"></i></button>-->
                  <!--</div>-->
                <!--</div>-->
              <!--</div>-->
            <!--</form>-->
          <!--</td>-->
          <!--<td>-->
           <!--To Date: <form class="form-inline">-->
          <!--<div class="form-group">-->
            <!--<div class="input-group">-->
              <!--<input class="form-control" placeholder="yyyy-mm-dd"-->
                     <!--name="dp2" [(ngModel)]="toDate" ngbDatepicker #e="ngbDatepicker">-->
              <!--<div class="input-group-append">-->
                <!--<button class="btn btn-outline-secondary" (click)="e.toggle()" type="button"><i class="fa fa-calendar"></i></button>-->
              <!--</div>-->
            <!--</div>-->
          <!--</div>-->
        <!--</form>-->
          <!--</td>-->
        <!--</tr>-->
        <tr>
          <td>
            From commit:
          </td>
          <td><input type="text" [(ngModel)]="fromCommit"/>
          </td>
          <td>
            To commit: </td>
          <td><input type="text" [(ngModel)]="toCommit"/>
          </td>
        </tr>
        <tr>
          <td>
            Boot args: </td>
          <td> <input type="text" [(ngModel)]="bootArgs"/>
          </td>
          <td>
            Type:
          </td>
          <td>
            <select [(ngModel)]="selectedOption">
        <option [value]="x" *ngFor="let x of triagingOptions">{{x}}</option>
      </select>
          </td>
        </tr>
        <tr>
          <td colspan="4">
            <button class="btn btn-sm no-margin btn-success" (click)="getInfoFromCommits()">Submit</button>
          </td>
        </tr>
      </table>

</div>
<div id="changed-files" class="component">
  <fun-spinner [status]="status"></fun-spinner>
  <div *ngIf="status===null">
    <div class="row">
      <div *ngIf="showCommits" class="col">
        <div class="card card-primary" style="margin: 4px;">
          <div class="card-header min-padding"><b>Commit history</b></div>
          <div class="card-body min-padding">
            <div class="min-padding">
              <span>
                <a [routerLink]="" (click)="showTotalFilesCHanged()" style="float: right">All files that changed</a>
                <button *ngIf="startButton" type="button" class="btn btn-primary" (click)="startTriaging()">Start triaging</button>
                <a *ngIf="!startButton" [routerLink]="" (click)="showTriaging()">Show triaging status</a>
              </span>
              <br><br>
              <br>
              <p class="no-margin"><b>Git info for first degrade:</b>
                <span>Sha:</span><span style="color: red"> {{ faultyCommit }}</span><br>
                <span>
                  Message:
                </span>
                <span style="color: red">
                {{ faultyMessage }}</span>
              </p><br>
              <p class="no-margin"><b>Git info before the first degrade:</b>
                <span>
                  Sha:</span> <span style="color: green"> {{ successCommit }}</span><br>
                <span>
                  Message:
                </span>
                <span style="color: green">
                {{ successMessage }}</span>
              </p><br>
              <table class="table table-bordered">
                <tr>
                  <th class="align msg-width">
                    <b>FunOS Git commit message</b>
                  </th>
                  <th class="align fc-width">
                    Files changed
                  </th>
                  <th class="align committer-width">
                    Committer
                  </th>
                  <th class="align">
                    <b>Committed date time</b>
                  </th>
                </tr>
                <tr class="no-margin" *ngFor="let commit of commits">
                  <td class="table-padding">
                    <span *ngIf="commit.hexsha==faultyCommit" class="text-color-red">{{ commit.message }}</span>
                    <span *ngIf="commit.hexsha==successCommit" class="text-color-green">{{ commit.message }}</span>
                    <span
                      *ngIf="commit.hexsha!=faultyCommit && commit.hexsha!=successCommit">{{ commit.message }}</span>
                  </td>
                  <td class="table-padding align">
                    <a [routerLink]="" (click)="showFilesChanged(commit)">{{ commit["changed_files"].length > 0 ?
                      commit["changed_files"].length: 'NA' }}</a>
                  </td>
                  <td class="table-padding align">
                    {{ commit.author }}
                  </td>
                  <td class="table-padding align">
                    {{ commit.date }}
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="showTriagingStatus" class="col">
        <button type="button" class="btn btn-outline-dark back-button" (click)="goBack()">Back</button>
        <button type="button" class="btn btn-outline-dark back-button" (click)="refreshStatus()">Refresh <i
          class="fa fa-refresh"></i></button>
        <br>
        <div class="card card-primary" style="margin: 4px;">
          <div class="card-header min-padding"><b>Triaging status:</b>&nbsp;<button class="btn btn-sm btn-danger">Kill triaging</button></div>
          <div class="card-body min-padding">
            <div class="min-padding">
              <table class="table table-borderless triage-status" style="width: 20%">
                <tr>
                  <th>
                    From git commit
                  </th>
                  <td>
                    {{ faultyCommit }}
                  </td>
                </tr>
                <tr>
                  <th>
                    To git commit
                  </th>
                  <td>
                    {{ successCommit }}
                  </td>
                </tr>
                <tr>
                  <th>
                    Boot args
                  </th>
                  <td>
                    {{ bootArgs }}
                  </td>
                </tr>
                <tr>
                  <th>
                    Triage id
                  </th>
                  <td>
                    {{ triageDetails.triage_id }}
                  </td>
                </tr>
                <tr>
                  <th>
                    Metric id
                  </th>
                  <td>
                    {{ triageDetails.metric_id }}
                  </td>
                </tr>
                <tr>
                  <th>
                    Triaging type
                  </th>
                  <td>
                    {{ triageDetails.metric_type }}
                  </td>
                </tr>
                <tr>
                  <th>
                    Status
                  </th>
                  <td>
                    <span [ngClass]="{'table-danger': triageStatus === 'FAILED'}">
                      <span [ngClass]="'text-'+
                          resultToClass(triageStatus)">{{ triageStatus }}</span>
                    </span>
                  </td>
                </tr>
                <tr>
                  <th>
                    Trials
                  </th>
                  <td>
                    {{ maxTries }}
                  </td>
                </tr>
                <tr>
                  <th>
                    Time elapsed
                  </th>
                  <td>
                    {{ timePercentage }}
                  </td>
                </tr>
                <!--<tr>-->
                  <!--<th class="align header-padding" style="width: 7%;">-->
                    <!--Triage id-->
                  <!--</th>-->
                  <!--<th class="align header-padding" style="width: 7%;">-->
                    <!--Metric id-->
                  <!--</th>-->
                  <!--<th class="align header-padding" style="width: 10%;">-->
                    <!--Metric type-->
                  <!--</th>-->
                  <!--&lt;!&ndash;<th class="align header-padding" style="width: 7%;">&ndash;&gt;-->
                    <!--&lt;!&ndash;Last good score&ndash;&gt;-->
                  <!--&lt;!&ndash;</th>&ndash;&gt;-->
                  <!--<th class="align header-padding" style="width: 10%;">-->
                    <!--Status-->
                  <!--</th>-->
                  <!--<th class="align header-padding" style="width: 5%;">-->
                    <!--Trials-->
                  <!--</th>-->
                  <!--<th class="align header-padding" style="width: 20%;">-->
                    <!--Time elapsed-->
                  <!--</th>-->
                <!--</tr>-->
                <!--<tr *ngFor="let id of triageDetails">-->
                  <!--<td class="align">-->
                    <!--{{ id.triage_id }}-->
                  <!--</td>-->
                  <!--<td class="align">-->
                    <!--{{ id.metric_id }}-->
                  <!--</td>-->
                  <!--<td class="align">-->
                    <!--{{ id.metric_type }}-->
                  <!--</td>-->
                  <!--&lt;!&ndash;<td class="align">&ndash;&gt;-->
                    <!--&lt;!&ndash;{{ id.last_good_score }}&ndash;&gt;-->
                  <!--&lt;!&ndash;</td>&ndash;&gt;-->
                  <!--<td class="align">-->
                    <!--<span [ngClass]="{'table-danger': triageStatus === 'FAILED'}">-->
                      <!--<span [ngClass]="'text-'+-->
                          <!--resultToClass(triageStatus)">{{ triageStatus }}</span>-->
                    <!--</span>-->
                  <!--</td>-->
                  <!--<td class="align">-->
                    <!--{{ maxTries }}-->
                  <!--</td>-->
                  <!--<td class="align">-->
                    <!--&lt;!&ndash;<span [ngClass]="{'table-danger': triageStatus === 'FAILED'}">&ndash;&gt;-->
                      <!--&lt;!&ndash;<span [ngClass]="'text-'+&ndash;&gt;-->
                          <!--&lt;!&ndash;resultToClass(triageStatus)">{{ triageStatus }}</span>&ndash;&gt;-->
                    <!--&lt;!&ndash;</span>&ndash;&gt;-->
                    <!--<span>-->
                      <!--{{ timePercentage }}-->
                    <!--</span>-->
                    <!--<div class="progress">-->
                      <!--<div id="dynamic-progress" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"-->
                          <!--aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%;"></div>-->
                    <!--</div>-->
                  <!--</td>-->
                <!--</tr>-->
              </table>
              <!--<div *ngIf="continueTriaging">Do you want to continue triaging?-->
              <!--<button type="button" class="btn btn-sm btn-outline-success" (click)="moreTriaging()">Yes</button>&nbsp;-->
              <!--<button type="button" class="btn btn-sm btn-outline-danger" (click)="stopTriaging()">No</button></div>-->
              <div *ngIf="!continueTriaging" style="font-weight: 900">
                <span class="text-color-green">Triaging complete</span><br>
                Potential faulty Commit: <a [routerLink]="" (click)="openFaultyCommitDetails(fault)" class="text-color-red">{{ fault }}</a><br>
                <br>
              </div>
              <ng-template #content let-c="close('Close click')" let-d="dismiss('Cross click')" let-o="close('OK click')">
                <div class="modal-header">
                  <h4 class="modal-title">Triaging done</h4>
                  <button type="button" class="close" aria-label="Close" (click)="d">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <p>A potential commit with degrade is found.<br>
                    <b>Do you want to continue triaging?</b></p>
                </div>
                <div class="modal-footer" style="align-items: center;">
                  <button type="button" class="btn btn-danger" (click)="o">Yes</button>
                  <button type="button" ngbAutofocus class="btn btn-outline-secondary" (click)="c">No</button>
                </div>
              </ng-template>
              <p><b>All flows:</b>&nbsp;
              <a [routerLink]="" (click)="advancedInfo = !advancedInfo">Show more info</a></p>
              <table class="table table-bordered" style="width: 60%">
                <tr>
                  <th *ngIf="advancedInfo" class="align">
                    Flow id
                  </th>
                  <th class="align">
                    Git commit
                  </th>
                  <th class="align">
                    Committer
                  </th>
                  <th *ngIf="advancedInfo" class="align">
                    Jenkins #
                  </th>
                  <th *ngIf="advancedInfo" class="align">
                    Lsf #
                  </th>
                  <th *ngIf="advancedInfo" class="align">
                    Score
                  </th>
                  <th class="align">
                    Status
                  </th>
                </tr>
                <tr class="no-margin">
                  <td *ngIf="advancedInfo" class="table-padding align">
                    NA
                  </td>
                  <td class="table-padding text-color-red">
                    {{ faultyCommit }}
                  </td>
                  <td class="table-padding align">
                    {{ faultyAuthor }}
                  </td>
                  <td *ngIf="advancedInfo" class="table-padding align">
                    NA
                  </td>
                  <td *ngIf="advancedInfo" class="table-padding align">
                    NA
                  </td>
                  <td *ngIf="advancedInfo" class="table-padding align">
                    NA
                  </td>
                  <td class="table-padding align">
                    NA
                  </td>
                </tr>
                <ng-container *ngFor="let commit of triageFlows">
                  <tr [ngClass]="{'grey-highlight': commit.status === 'SUSPENDED'}" class="no-margin">
                  <td *ngIf="advancedInfo" class="table-padding align">
                    {{ commit.flow_id }}
                  </td>
                  <td class="table-padding" style="vertical-align: middle">
                    {{ commit.git_commit }}
                  </td>
                  <td class="table-padding align">
                    {{ commit.committer }}
                  </td>
                  <td *ngIf="advancedInfo" class="table-padding align">
                    <span *ngIf="commit.jenkins !== -1">{{ commit.jenkins }}</span>
                  </td>
                  <td *ngIf="advancedInfo" class="table-padding align">
                    <span *ngIf="commit.lsf !== -1">{{ commit.lsf }}</span>
                  </td>
                  <td *ngIf="advancedInfo" class="table-padding align">
                    <span *ngIf="commit.score != -1">{{ commit.score }}</span>
                  </td>
                  <td class="table-padding align">
                    <span [ngClass]="{'table-danger': commit.status === 'FAILED'}">
                      <span [ngClass]="'text-'+
                          resultToClass(commit.status)">{{ commit.status }}</span>
                    </span>
                    <!--<div *ngIf="(commit.status !== 'SUSPENDED' || commit.status === 'FAILED') && commit.score === -1"-->
                         <!--class="progress">-->
                      <!--<div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"-->
                           <!--aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%"></div>-->
                    <!--</div>-->
                  </td>
                </tr>
                </ng-container>
                <tr class="no-margin">
                  <td *ngIf="advancedInfo" class="table-padding align">
                    NA
                  </td>
                  <td class="table-padding text-color-green">
                    {{ successCommit }}
                  </td>
                  <td class="table-padding align">
                    {{ successAuthor }}
                  </td>
                  <td *ngIf="advancedInfo" class="table-padding align">
                    NA
                  </td>
                  <td *ngIf="advancedInfo" class="table-padding align">
                    NA
                  </td>
                  <td *ngIf="advancedInfo" class="table-padding align">
                    NA
                  </td>
                  <td class="table-padding align">
                    NA
                  </td>
                </tr>
              </table>
              <!--<button *ngIf="continueTriaging" type="button" (click)="testEntry()">Test</button>-->
            </div>
          </div>
        </div>
      </div>
       <div *ngIf="showChanged" class="col">
        <div class="card card-primary" style="margin: 4px;">
          <div class="card-header min-padding"><b>Files changed:</b></div>
          <div class="card-body min-padding">
            <div class="min-padding">
              <p *ngIf="!totalShow"><b>Git commit:</b> {{ gitCommit }}<br>
                <b>User:</b> {{ gitUser }}</p>
              <p class="no-margin" *ngFor="let fileNames of changedFiles">
                {{ fileNames }}
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
