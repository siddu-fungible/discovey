<div class="component">
  <div class="container">
    <div class="row">
      <div class="col">
        <div class="card">
          <div class="card-header">
            Testbeds
          </div>
          <div class="card-body">
            <table class="table table-nonfluid">
              <tr>
                <th class="text-center" rowspan="2">Name</th>
                <th rowspan="2">Description</th>
                <th colspan="2">Regression lock</th>
                <th colspan="3">Manual lock</th>
              </tr>
              <tr>
                <th>Status</th>
                <th>Locked by</th>
                <th>Status</th>
                <th>Action</th>
                <th>Locked by</th>
              </tr>

              <tr *ngFor="let testBed of testBeds">
                <td>{{ testBed.name }}</td>
                <td>{{ testBed.description }}</td>
                <td>
                  <span class="badge badge-danger"
                        *ngIf="automationStatus[testBed.name]?.numExecutions > 0; else freeAutomationStatus">In use</span>
                  <ng-template #freeAutomationStatus>
                    <span class="badge badge-success">Free</span>
                  </ng-template>
                </td>
                <td>
                  <a *ngIf="automationStatus[testBed.name].numExecutions > 0" target="_blank"
                     href="/regression/suite_detail/{{ automationStatus[testBed.name].executionId}}">Suite:
                    {{ automationStatus[testBed.name].executionId }}</a>
                </td>
                <td>
                  <span class="badge badge-danger"
                        *ngIf="automationStatus[testBed.name].manualLock; else freeManualStatus">In use</span>
                  <ng-template #freeManualStatus>
                    <span class="badge badge-success">Free</span>
                  </ng-template>
                </td>
                <td>
                  <ng-container *ngIf="!automationStatus[testBed.name].manualLock">
                    <span class="pseudo-anchor" (click)="onLock(testBed)">Lock</span>
                    &nbsp;
                  </ng-container>
                  <ng-container *ngIf="automationStatus[testBed.name].manualLock">
                    <span class="pseudo-anchor" (click)="onUnLock(testBed)">Un-lock</span>
                    &nbsp;
                    <span class="pseudo-anchor" (click)="onExtendTime(testBed)">Extend slot</span>
                  </ng-container>

                </td>
              </tr>

            </table>

          </div>
        </div>
      </div>
      <div class="col" *ngIf="currentEditMode !== EditMode.NONE">
        <div class="card">
          <div class="card-header">
            {{ lockPanelHeader }}
            <span style="float:right;" (click)="onCloseLockPanel()" class="pseudo-anchor">Close</span>
          </div>
          <div class="card-body">



            <table>

              <tr>
                <td class="no-wrap">
                  <label for="submitter">Submitter</label>
                </td>
                <td>
                  <select id="submitter" [(ngModel)]="selectedUser">
                    <option *ngFor="let user of users" [ngValue]="user">{{ user.first_name }} {{ user.last_name }}
                      ({{ user.email }})
                    </option>
                  </select>
                  &nbsp;
                  <a href="/users" target="_blank">Add user</a>
                </td>
              </tr>
              <tr>

              </tr>
              <tr>
                <td colspan="2">
              <table>
                <tr>
                  <td>HH:MM (Duration from now)</td>
                  <td>
                    <ngb-timepicker style="display: inline-flex" id="scheduling-time-picker"
                                    [(ngModel)]="schedulingTime"></ngb-timepicker>
                  </td>
                </tr>
              </table>

                 </td>
              </tr>
              <tr>
                <button class="btn btn-sm btn-outline-success"> Submit
</button>
              </tr>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
