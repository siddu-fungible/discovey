<!--<p class="component">-->
<!--<button (click)="test()">Test</button>-->
<!--</p>-->

<div class="row component">
  <div class="col">
    <ng-container *ngFor="let filter of filters">

      <app-regression-summary-chart [title]="filter.info" [metadata]="filter.metadata"
                                    (pointInfo)="showPointDetails($event)" [pointClickCallback]="pointClickCallback"
                                    [testCaseExecutions]="filter.testCaseExecutions" [versionSet]="versionSet"
                                    [suiteExectionVersionMap]="suiteExectionVersionMap"></app-regression-summary-chart>

    </ng-container>


  </div>
  <div class="col">
    <span id="detailed-info"></span>
    <div class="card-body" *ngIf="showDetailedInfo && detailedInfo">
      <table class="table">
        <tr>
          <th>Software version: {{ detailedInfo.softwareVersion }} </th>
          <th><label class="badge badge-success">Passed</label></th>
          <th><label class="badge badge-danger">Failed</label></th>
          <th><label class="badge badge-secondary">Not-run</label></th>
        </tr>
        <tr>
          <td>Total</td>
          <td>{{ detailedInfo.numPassed }}</td>
          <td>{{ detailedInfo.numFailed }}</td>
          <td>{{ detailedInfo.numNotRun }}</td>

        </tr>
        <ng-container *ngFor="let scriptInfo of detailedInfo.scriptDetailedInfo | keyvalue">
          <tr *ngIf="scriptInfo.value.historyResults">
            <td>
              {{ scriptInfo.key }}
              <u (click)="scriptInfo.value.showingDetails = !scriptInfo.value.showingDetails" class="anchor-button pseudo-anchor">details</u>
            </td>
            <td>{{ scriptInfo.value.historyResults.numPassed }}</td>
            <td>{{ scriptInfo.value.historyResults.numFailed }}</td>
            <td>{{ scriptInfo.value.historyResults.numNotRun }}</td>

          </tr>
          <tr *ngIf="scriptInfo.value.showingDetails">
            <td colspan="4">
              <table class="table">
                <tr>
                  <th>Result</th>
                  <th>Suite execution ID</th>
                  <th>TC-ID</th>
                  <th>Summary</th>
                </tr>
                <tr *ngFor="let executionEntry of scriptInfo.value.history">
                  <td><span
                    [ngClass]="{'failed': executionEntry.result === 'FAILED', 'passed': executionEntry.result === 'PASSED'}">{{ executionEntry.result }}</span>
                  </td>
                  <td><a target="_blank"
                         href="/regression/suite_detail/{{ executionEntry.suite_execution_id }}">{{ executionEntry.suite_execution_id }}</a>
                  </td>
                  <td>{{ executionEntry.test_case_id }}</td>
                  <td>{{ executionEntry.summary }}</td>
                </tr>
              </table>
            </td>
          </tr>
        </ng-container>

      </table>

    </div>
  </div>
</div>

