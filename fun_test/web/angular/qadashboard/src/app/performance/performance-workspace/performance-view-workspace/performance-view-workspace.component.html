<!--shows the data for a particular workspace-->
<div style="padding: 20px"><span class="pseudo-anchor" (click)="backToWorkspaces()"><< Back to workspaces</span></div>
<div *ngIf="showWorkspace" class="card card-primary">
  <div class="card-header">
    <h5 class="card-title" style="margin: 0;">{{ workspace.workspace_name }}</h5>
    <span class="pseudo-anchor" *ngIf="workspace.interested_metrics.length > 0 && !showGrids"
          (click)="showGrids = true">Show charts</span>
    <span class="pseudo-anchor" *ngIf="workspace.interested_metrics.length > 0 && showGrids"
          (click)="showGrids = false">Hide charts</span> |
    <span class="pseudo-anchor" *ngIf="workspace.interested_metrics.length > 0 && !reportGenerated"
          (click)="generateReport()">Show report
    </span>
    <span class="pseudo-anchor" *ngIf="workspace.interested_metrics.length > 0 && reportGenerated"
          (click)="reportGenerated = false">Hide report
    </span>
  </div>
  <div class="card-body flex-container">
     <!--showing list of charts in the workspace-->
    <div class="card" style="flex: 1 1 50%; padding: 10px;">
      <table style="width: 100%">
        <tr style="vertical-align: top">
          <th style="width: 30%">
            Chart name
          </th>
          <!--<th style="width: 10%">-->
          <!--Track-->
          <!--</th>-->
          <!--<th style="width: 10%">-->
          <!--Subscribe to alerts-->
          <!--</th>-->
          <th style="width: 10%">
            Yesterday's score
          </th>
          <th style="width: 10%">
            Today's score
          </th>
          <th style="width: 30%">
            Lineage
          </th>
        </tr>
        <tr *ngFor="let metric of workspace.interested_metrics">
          <td>
            <span class="pseudo-anchor" [ngClass]="{highlight:metric.selected}" (click)="openChartTable(metric)">{{
              metric['chart_name'] }}</span>
          </td>
          <!--<td>-->
          <!--<app-toggle-button [checked]="metric['track']" [disabled]="true"-->
          <!--&gt;</app-toggle-button>-->
          <!--</td>-->
          <!--<td>-->
          <!--<app-toggle-button [checked]="metric['subscribe']" [disabled]="true"-->
          <!--&gt;</app-toggle-button>-->
          <!--</td>-->
          <td>
            {{ metric["penultimate_good_score"] }}
          </td>
          <td>
            {{ metric["last_good_score"] }}
          </td>
          <td>
            {{ metric["lineage"] }}
          </td>
        </tr>
      </table>
    </div>

    <fun-spinner [status]="status"></fun-spinner>
     <!--showing chart report in the right on the workspace-->
    <div *ngIf="showChartTable" class="card" style="flex: 1 1 50%; vertical-align: top; padding: 10px;">
      <span><b>Chart name: </b>{{ currentChart.chart_name }}
      <span class="pseudo-anchor" style="float: right" (click)="closeChartTable()">Close</span></span>
      <table style="width: 100%">
        <tr style="border-bottom: solid black 1px">
          <th style="width: 30%">
            Name
          </th>
          <th style="width: 20%">
            Yesterday <br><span style="font-size: smaller">{{ currentChart.data[0].yesterdayDate }}</span>
          </th>
          <th style="width: 20%">
            Today <br><span style="font-size: smaller">{{ currentChart.data[0].todayDate }}</span>
          </th>
          <th style="width: 10%">
            Percentage change
          </th>
          <th style="width: 10%">
            Unit
          </th>
        </tr>
        <tr *ngFor="let oneData of currentChart.data">
          <td>
            {{ oneData.name }}
          </td>
          <td>
            {{ oneData.yesterday }}
          </td>
          <td>
            {{ oneData.today }}
          </td>
          <td *ngIf="oneData.percentage && currentChart.positive"
              [ngClass]="{'text-red': oneData.percentage.includes('-'), 'text-green': oneData.percentage.includes('+')}">
            {{ oneData.percentage }}
          </td>
          <td *ngIf="oneData.percentage && !currentChart.positive"
              [ngClass]="{'text-green': oneData.percentage.includes('-'), 'text-red': oneData.percentage.includes('+')}">
            {{ oneData.percentage }}
          </td>
          <td>
            {{ oneData.unit }}
          </td>
        </tr>
      </table>
    </div>
  </div>

   <!--showing reports in the workspace-->
  <ng-container *ngIf="reportGenerated">
    <performance-show-report [workspace]="workspace" [email]="email" [subject]="subject"
                             (reportGenerated)="reportGenerated = false"></performance-show-report>
  </ng-container>

  <!--showing charts in the workspace-->
  <ng-container *ngIf="showGrids">
    <performance-show-charts [workspace]="workspace" [buildInfo]="buildInfo"></performance-show-charts>
  </ng-container>
</div>
