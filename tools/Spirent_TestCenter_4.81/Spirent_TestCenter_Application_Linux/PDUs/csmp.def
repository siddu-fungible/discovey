<?xml version="1.0" encoding="UTF-8"?>
<PDU_LIBRARY
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="pdu_schema.xsd"
  name="csmp"
  showName="CSMP"
  version="1.00"
  description="This is a sample PDU library for CoAP Simple Management Protocol (CSMP) as defined in XML Stream Editor."
  userdefined="true">

  <TYPE_DEFS>

    <!-- CSMP TLVs ======================================================= -->

    <TYPE_DEF name="TLVType" type="INTEGER" bitLength="8" minValue="0" maxValue="127" unitType="ELEMENT">
        <VALUE_ENUMERATION>
            <!-- Discovery -->
            <VAL_ENUM uiShowName="01 - Tlv Index" value="1" />
            <!-- Registration -->
            <VAL_ENUM uiShowName="02 - Device ID" value="2" />
            <VAL_ENUM uiShowName="03 - Agent URL" value="3" />
            <VAL_ENUM uiShowName="04 - Firmware Group" value="4" />
            <VAL_ENUM uiShowName="05 - Config Group" value="5" />
            <VAL_ENUM uiShowName="06 - NMS Redirect Request" value="6" />
            <VAL_ENUM uiShowName="07 - Session ID" value="7" />
            <VAL_ENUM uiShowName="08 - Description Request" value="8" />
            <VAL_ENUM uiShowName="09 - Config Request" value="9" />
            <VAL_ENUM uiShowName="10 - Firmware Request" value="10" />
            <!-- Description -->
            <VAL_ENUM uiShowName="11 - Hardware Description" value="11" />
            <VAL_ENUM uiShowName="12 - Interface Description" value="12" />
            <!-- Configuration -->
            <VAL_ENUM uiShowName="13 - Report Period" value="13" />
            <VAL_ENUM uiShowName="14 - Report List" value="14" />
            <VAL_ENUM uiShowName="15 - IP Forwarding" value="15" />
            <VAL_ENUM uiShowName="16 - IP Address" value="16" />
            <VAL_ENUM uiShowName="17 - IP Route" value="17" />
            <VAL_ENUM uiShowName="18 - Current Time" value="18" />
            <VAL_ENUM uiShowName="19 - Interface Settings" value="19" />
            <VAL_ENUM uiShowName="20 - WPAN Settings" value="20" />
            <VAL_ENUM uiShowName="21 - RPL Settings" value="21" />
            <!-- Monitoring -->
            <VAL_ENUM uiShowName="22 - Uptime" value="22" />
            <VAL_ENUM uiShowName="23 - Interface Metrics" value="23" />
            <VAL_ENUM uiShowName="24 - Interface Detail Metrics" value="24" />
            <VAL_ENUM uiShowName="25 - IP Route RPL Metrics" value="25" />
            <!-- Event Reporting -->
            <VAL_ENUM uiShowName="26 - Log Record" value="26" />
            <VAL_ENUM uiShowName="27 - Syslog Event" value="27" />
            <!-- Control -->
            <VAL_ENUM uiShowName="28 - Echo Request" value="28" />
            <VAL_ENUM uiShowName="29 - Echo Response" value="29" />
            <VAL_ENUM uiShowName="30 - Ping Request" value="30" />
            <VAL_ENUM uiShowName="31 - Pint Response" value="31" />
            <VAL_ENUM uiShowName="32 - Reboot Request" value="32" />
            <VAL_ENUM uiShowName="33 - Reboot Response" value="33" />
            <VAL_ENUM uiShowName="34 - Send RA Request" value="34" />
            <VAL_ENUM uiShowName="35 - Send RA Response" value="35" />
            <VAL_ENUM uiShowName="36 - Send DHCP Request" value="36" />
            <VAL_ENUM uiShowName="37 - Send DHCP Response" value="37" />
            <VAL_ENUM uiShowName="38 - Send RR Request" value="38" />
            <VAL_ENUM uiShowName="39 - Send RR Response" value="39" />
            <VAL_ENUM uiShowName="40 - Send Report Request" value="40" />
            <VAL_ENUM uiShowName="41 - Clear Dag Routes Request" value="41" />
            <VAL_ENUM uiShowName="42 - Clear Dag Routes Response" value="42" />
            <VAL_ENUM uiShowName="43 - Change Firmware Request" value="43" />
            <VAL_ENUM uiShowName="44 - Change Firmware Response" value="44" />
            <VAL_ENUM uiShowName="45 - Load Firmware Request" value="45" />
            <VAL_ENUM uiShowName="46 - Load Firmware Response" value="46" />
            <VAL_ENUM uiShowName="47 - Cancel Firmware Request" value="47" />
            <VAL_ENUM uiShowName="48 - Cancel Firmware Response" value="48" />
            <VAL_ENUM uiShowName="49 - Silence Request" value="49" />
            <!-- New TLVs (sort later) -->
            <VAL_ENUM uiShowName="50 - WPAN Status" value="50" />
            <VAL_ENUM uiShowName="51 - CGMS Status" value="51" />
            <VAL_ENUM uiShowName="52 - Ieee8021xStatus" value="52" />
            <VAL_ENUM uiShowName="53 - Ieee80211iStatus" value="53" />
            <VAL_ENUM uiShowName="54 - RebootRequest" value="54" />
            <VAL_ENUM uiShowName="55 - CGMSStats" value="55" />
            <VAL_ENUM uiShowName="56 - RPLInstance" value="56" />
            <VAL_ENUM uiShowName="57 - RPLParent" value="57" />
            <VAL_ENUM uiShowName="58 - CGMSSettings" value="58" />
            <VAL_ENUM uiShowName="59 - CGMSNotification" value="59" />
            <VAL_ENUM uiShowName="60 - TransferRequest" value="60" />
            <VAL_ENUM uiShowName="61 - FirmwareImageInfo" value="61" />
        </VALUE_ENUMERATION>
    </TYPE_DEF>

    
    <!-- CSMP Length Selection =========================================== -->
    
    <TYPE_DEF name="LengthOneByte" type="SEQUENCE" unitType="ELEMENT" uiShowName="Length">
        <FIELD name="length" type="INTEGER" bitLength="8"
            minValue="0"
            maxValue="127"
            defaultValue="0"
            uiControlState="ALLOW_OVERRIDE"
            procfnTarget="CSMP1BYTELENGTH"
            uiShowName="Length" />
    </TYPE_DEF>
    
    <TYPE_DEF name="LengthTwoByte" type="SEQUENCE" unitType="ELEMENT" uiShowName="Length">
        <FIELD name="length" type="BITSTRING" bitLength="16"
            defaultValue="0"
            uiShowName="Length" />
    </TYPE_DEF>
    
    <TYPE_DEF name="LengthSizeChoice" type="CHOICE" unitType="ELEMENT" uiShowName="Length size">
        <FIELD name="lengthOne" type="LengthOneByte"
            uiShowName="1 Byte" />
        <FIELD name="lengthTwo" type="LengthTwoByte"
            uiShowName="2 Bytes" />
    </TYPE_DEF>
    
    
    <!-- Generic CSMP TLV ================================================ -->

    <TYPE_DEF name="TLV" type="SEQUENCE" unitType="ELEMENT" uiShowName="TLV">
		<FIELD name="type" type="TLVType"
			defaultValue="1"
            uiShowName="Type" />
        <FIELD name="lengthSize" type="LengthSizeChoice"
            defaultValue="lengthOne"
            uiShowName="Length size" />
        <FIELD name="value" type="OCTETSTRING" minByteLength="0" maxByteLength="16383"
            defaultValue=""
            uiShowName="Encoded value" />
	</TYPE_DEF>

    <TYPE_DEF name="CSMPTLV" type="SEQUENCE_OF" minOccurs="0" maxOccurs="999" elementType="TLV" unitType="ELEMENT" uiShowName="CSMP TLV"/>


    <!-- CSMP Header ===================================================== -->
    
    <TYPE_DEF name="CSMP" type="SEQUENCE" unitType="HEADER" uiShowName="CSMP Header">
  
        <FIELD name="tlvs" type="CSMPTLV"
            uiShowName="TLVs" />
          
        <NEXT_HEADERS>
            <NXT_HDR id="custom:Custom" name="Custom" value="0" />
			<NXT_HDR id="customrepeat:CustomRepeat" name="CustomRepeat" value="0" />
        </NEXT_HEADERS>
      
    </TYPE_DEF>


  </TYPE_DEFS>
</PDU_LIBRARY>
