<?xml version="1.0" encoding="UTF-8"?>
<PDU_LIBRARY xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="pdu_schema.xsd"
  name="gtpv1"
  showName="GTPv1"
  version="1.00"
  description="This is a sample PDU library for GTPv1 as defined in XML Stream Editor.">

  <TYPE_DEFS>

    <TYPE_DEF name="gtpv1Boolean" type="INTEGER" bitLength="1" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="False" value="0" />
        <VAL_ENUM uiShowName="True"  value="1" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="gtpv1ProtcolType" type="INTEGER" bitLength="1" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="GTP'" value="0" />
        <VAL_ENUM uiShowName="GTP"  value="1" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="gtpv1ExtHdrFlg" type="INTEGER" bitLength="1" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="Extended Header Flag off" value="0" />
        <VAL_ENUM uiShowName="Extended Header Flag on"  value="1" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="gtpv1SeqNumFlg" type="INTEGER" bitLength="1" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="Sequence Number Flag off" value="0" />
        <VAL_ENUM uiShowName="Sequence Number Flag on"  value="1" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="gtpv1pnFlg" type="INTEGER" bitLength="1" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="N-PDU Number Flag off" value="0" />
        <VAL_ENUM uiShowName="N-PDU Number Flag on"  value="1" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="GTPv1" type="SEQUENCE" unitType="HEADER" portType="Ethernet" uiShowName="GTPv1 Header" >
      <FIELD name="version"  type="INTEGER"           bitLength="3"  defaultValue="1" uiShowName="Version" />
      <FIELD name="protcol"  type="gtpv1ProtcolType"  bitLength="1"  defaultValue="1" uiShowName="Protocol Type" />
      <FIELD name="reserved" type="gtpv1Boolean"      bitLength="1"  defaultValue="0" uiShowName="Reserved" />
      <FIELD name="eFlg"     type="gtpv1ExtHdrFlg"    bitLength="1"  defaultValue="0" uiShowName="Extended Header Flag" />
      <FIELD name="sFlg"     type="gtpv1SeqNumFlg"    bitLength="1"  defaultValue="0" uiShowName="Sequence Number Flag" />
      <FIELD name="pnFlg"    type="gtpv1pnFlg"        bitLength="1"  defaultValue="0" uiShowName="N-PDU Number Flag" />
      <FIELD name="msgType"  type="INTEGER"           bitLength="8"  defaultValue="0" uiShowName="Message Type" />
      <FIELD name="mlength"  type="INTEGER"           bitLength="16" defaultValue="8" uiControlState="CALCULATED" binder="calculated" procfnTarget="PAYLOADLENGTH" uiShowName="Total Length" />
      <FIELD name="teid"     type="INTEGER"           bitLength="32" defaultValue="0" uiShowName="Tunnel Endpoint ID" />

      <NEXT_HEADERS>
        <NXT_HDR id="custom:Custom" name="Custom" value="0" />
        <NXT_HDR id="customrepeat:CustomRepeat" name="CustomRepeat" value="00" />
        <NXT_HDR id="ipv4:IPv4" name="IPv4 Header" value="4" />
        <NXT_HDR id="ipv6:IPv6" name="IPv6 Header" value="41" />
    	<NXT_HDR id="gtpv1_ext:GTPv1Ext" name="GTPv1 Optional Fields and Extension Header" value="139" />
    	<NXT_HDR id="gtpv1:GTPv1Opt" name="GTPv1 Optional Fields" value="140" />
      </NEXT_HEADERS>
    </TYPE_DEF>

    <TYPE_DEF name="GTPv1Opt"  type="SEQUENCE" unitType="HEADER" portType="Ethernet" uiShowName="GTPv1 Optional Fields" >
        <FIELD name="seqno"    type="INTEGER"           bitLength="16"    defaultValue="0" uiShowName="Sequence Number" />
        <FIELD name="Npdu"     type="INTEGER"           bitLength="8"     defaultValue="0" uiShowName="N-PDU Number" />
        <FIELD name="nExtHdr"  type="INTEGER"           bitLength="8"     defaultValue="0" uiShowName="Next Extension Header Type" />
  
        <NEXT_HEADERS>
            <NXT_HDR id="custom:Custom" name="Custom" value="0" />
            <NXT_HDR id="customrepeat:CustomRepeat" name="CustomRepeat" value="00" />
            <NXT_HDR id="ipv4:IPv4" name="IPv4 Header" value="4" />
            <NXT_HDR id="ipv6:IPv6" name="IPv6 Header" value="41" />
    	    <NXT_HDR id="gtpv1_ext:GTPv1ExtHdr" name="GTPv1 Extension Header" value="3387" />
        </NEXT_HEADERS>
    </TYPE_DEF>

  </TYPE_DEFS>
</PDU_LIBRARY>
