<?xml version="1.0" encoding="UTF-8"?>
<PDU_LIBRARY xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="pdu_schema.xsd"
  name="oncrpcv2"
  showName="ONC RPCv2"
  version="1.00"
  description="This is a sample PDU library for Fibre Channel as defined in XML Stream Editor.">

  <TYPE_DEFS>

    <TYPE_DEF name="VariableLengthOpaqueData" type="SEQUENCE" unitType="ELEMENT"
      uiShowName="opaque_auth">
      <FIELD name="length" type="INTEGER" bitLength="32" defaultValue="0" uiNoShowModifier="Interface,Frame,Filter" uiShowName="length"/>
      <FIELD name="data" type="OCTETSTRING" minByteLength="0" maxByteLength="400" defaultValue="" uiNoShowModifier="Interface,Filter" uiShowName="data"/>
      <FIELD name="padding" type="ALIGNMENTPAD" xAlignment="4" yAlignment="0" padType="NONE" defaultValue="0" uiNoShow="Filter,Frame,Interface" uiShowName="4 Byte Alignment Padding"/>
    </TYPE_DEF>

    <TYPE_DEF name="AuthFlavor" type="INTEGER" bitLength="32" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="AUTH_NONE" value="0" />
        <VAL_ENUM uiShowName="AUTH_SYS" value="1" />
        <VAL_ENUM uiShowName="AUTH_SHORT" value="2" />
        <VAL_ENUM uiShowName="AUTH_DH" value="3" />
        <VAL_ENUM uiShowName="RPCSEC_GSS" value="6" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="OpaqueAuth" type="SEQUENCE" unitType="ELEMENT"
      uiShowName="opaque_auth">
      <FIELD name="flavor" type="AuthFlavor" defaultValue="0" uiNoShowModifier="Interface,Frame,Filter" uiShowName="flavor"/>
      <FIELD name="body" type="VariableLengthOpaqueData" uiNoShowModifier="Interface,Filter" uiShowName="body"/>
    </TYPE_DEF>

    <TYPE_DEF name="MsgType" type="INTEGER" bitLength="32" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="CALL" value="0" />
        <VAL_ENUM uiShowName="REPLY" value="1" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="ReplyStat" type="INTEGER" bitLength="32" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="MSG_ACCEPTED" value="0" />
        <VAL_ENUM uiShowName="MSG_DENIED" value="1" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="AcceptStat" type="INTEGER" bitLength="32" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="SUCCESS" value="0" />
        <VAL_ENUM uiShowName="PROG_UNAVAIL" value="1" />
        <VAL_ENUM uiShowName="PROG_MISMATCH" value="2" />
        <VAL_ENUM uiShowName="PROC_UNAVAIL" value="3" />
        <VAL_ENUM uiShowName="GARBAGE_ARGS" value="4" />
        <VAL_ENUM uiShowName="SYSTEM_ERR" value="5" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="RejectStat" type="INTEGER" bitLength="32" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="RPC_MISMATCH" value="0" />
        <VAL_ENUM uiShowName="AUTH_ERROR" value="1" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="AuthStat" type="INTEGER" bitLength="32" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="AUTH_OK" value="0" />
        <VAL_ENUM uiShowName="AUTH_BADCRED" value="1" />
        <VAL_ENUM uiShowName="AUTH_REJECTEDCRED" value="2" />
        <VAL_ENUM uiShowName="AUTH_BADVERF" value="3" />
        <VAL_ENUM uiShowName="AUTH_REJECTEDVERF" value="4" />
        <VAL_ENUM uiShowName="AUTH_TOOWEAK" value="5" />
        <VAL_ENUM uiShowName="AUTH_INVALIDRESP" value="6" />
        <VAL_ENUM uiShowName="AUTH_FAILED" value="7" />
        <VAL_ENUM uiShowName="AUTH_KERB_GENERIC" value="8" />
        <VAL_ENUM uiShowName="AUTH_TIMEEXPIRE" value="9" />
        <VAL_ENUM uiShowName="AUTH_TKT_FILE" value="10" />
        <VAL_ENUM uiShowName="AUTH_DECODE" value="11" />
        <VAL_ENUM uiShowName="AUTH_NET_ADDR" value="12" />
        <VAL_ENUM uiShowName="RPCSEC_GSS_CREDPROBLEM" value="13" />
        <VAL_ENUM uiShowName="RPCSEC_GSS_CTXPROBLEM" value="14" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="CallBody" type="SEQUENCE" unitType="HEADER" uiShowName="call_body">
      <FIELD name="rpcvers" type="INTEGER" bitLength="32" defaultValue="2" uiNoShowModifier="Interface,Filter" uiShowName="rpcvers"/>
      <FIELD name="prog" type="INTEGER" bitLength="32" defaultValue="0" uiNoShowModifier="Interface,Filter" uiShowName="prog"/>
      <FIELD name="vers" type="INTEGER" bitLength="32" defaultValue="0" uiNoShowModifier="Interface,Filter" uiShowName="vers"/>
      <FIELD name="proc" type="INTEGER" bitLength="32" defaultValue="0" uiNoShowModifier="Interface,Filter" uiShowName="proc"/>
      <FIELD name="cred" type="OpaqueAuth" uiNoShowModifier="Interface,Frame,Filter" uiShowName="cred"/>
      <FIELD name="verf" type="OpaqueAuth" uiNoShowModifier="Interface,Frame,Filter" uiShowName="verf"/>

      <NEXT_HEADERS>
        <NXT_HDR id="custom:Custom" name="Custom" value="0"/>
		<NXT_HDR id="customrepeat:CustomRepeat" name="CustomRepeat" value="00" />
      </NEXT_HEADERS>
    </TYPE_DEF>

    <TYPE_DEF name="MismatchInfo" type="SEQUENCE" unitType="HEADER" uiShowName="mismatch_info">
      <FIELD name="low" type="INTEGER" bitLength="32" defaultValue="0" uiNoShowModifier="Interface,Filter" uiShowName="low"/>
      <FIELD name="high" type="INTEGER" bitLength="32" defaultValue="0" uiNoShowModifier="Interface,Filter" uiShowName="high"/>
    </TYPE_DEF>

    <TYPE_DEF name="AcceptedReply" type="SEQUENCE" unitType="HEADER" uiShowName="accepted_reply">
      <FIELD name="verf" type="OpaqueAuth" uiNoShowModifier="Interface,Frame,Filter" uiShowName="verf"/>
      <FIELD name="stat" type="AcceptStat" defaultValue="0" uiNoShowModifier="Interface,Frame,Filter" uiControlState="ALLOW_OVERRIDE" procfnTarget="NEXTHDR" uiShowName="stat"/>

      <NEXT_HEADERS>
        <NXT_HDR id="oncrpcv2:MismatchInfo" name="PROG_MISMATCH" value="2"/>

        <NXT_HDR id="custom:Custom" name="Custom" value="255"/>
		<NXT_HDR id="customrepeat:CustomRepeat" name="CustomRepeat" value="255" />
      </NEXT_HEADERS>
    </TYPE_DEF>

    <TYPE_DEF name="RejectedReplyAuthStat" type="SEQUENCE" unitType="HEADER" uiShowName="auth_stat">
      <FIELD name="stat" type="AuthStat" defaultValue="0" uiNoShowModifier="Interface,Frame,Filter" uiShowName="stat"/>
    </TYPE_DEF>

    <TYPE_DEF name="RejectedReply" type="SEQUENCE" unitType="HEADER" uiShowName="rejected_reply">
      <FIELD name="stat" type="RejectStat" defaultValue="0" uiNoShowModifier="Interface,Frame,Filter" uiControlState="ALLOW_OVERRIDE" procfnTarget="NEXTHDR" uiShowName="stat"/>

      <NEXT_HEADERS>
        <NXT_HDR id="oncrpcv2:MismatchInfo" name="RPC_MISMATCH" value="0"/>
        <NXT_HDR id="oncrpcv2:RejectedReplyAuthStat" name="AUTH_ERROR" value="1"/>
      </NEXT_HEADERS>
    </TYPE_DEF>

    <TYPE_DEF name="ReplyBody" type="SEQUENCE" unitType="HEADER" uiShowName="reply_body">
      <FIELD name="stat" type="ReplyStat" defaultValue="0" uiNoShowModifier="Interface,Frame,Filter" uiControlState="ALLOW_OVERRIDE" procfnTarget="NEXTHDR" uiShowName="stat"/>

      <NEXT_HEADERS>
        <NXT_HDR id="oncrpcv2:AcceptedReply" name="MSG_ACCEPTED" value="0"/>
        <NXT_HDR id="oncrpcv2:RejectedReply" name="MSG_DENIED" value="1"/>

        <NXT_HDR id="custom:Custom" name="Custom" value="255"/>
		<NXT_HDR id="customrepeat:CustomRepeat" name="CustomRepeat" value="255" />
      </NEXT_HEADERS>
    </TYPE_DEF>

    <TYPE_DEF name="RpcMsg" type="SEQUENCE"  unitType="HEADER" uiShowName="rpc_msg">
      <FIELD name="xid" type="INTEGER" bitLength="32" defaultValue="0" uiNoShowModifier="Interface,Filter" uiShowName="xid"/>
      <FIELD name="mtype" type="MsgType" defaultValue="0" uiNoShowModifier="Interface,Frame,Filter" uiControlState="ALLOW_OVERRIDE" procfnTarget="NEXTHDR" uiShowName="mtype"/>

      <NEXT_HEADERS>
        <NXT_HDR id="oncrpcv2:CallBody" name="cbody" value="0"/>
        <NXT_HDR id="oncrpcv2:ReplyBody" name="rbody" value="1"/>

        <NXT_HDR id="custom:Custom" name="Custom" value="255"/>
		<NXT_HDR id="customrepeat:CustomRepeat" name="CustomRepeat" value="255" />
      </NEXT_HEADERS>
    </TYPE_DEF>

  </TYPE_DEFS>
</PDU_LIBRARY>
