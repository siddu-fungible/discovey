<?xml version="1.0" encoding="UTF-8"?>
<PDU_LIBRARY xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="pdu_schema.xsd" name="bfd" showName="BFD" version="1.00"
    description="This is a sample PDU library for BFD as defined in XML Stream Editor." userdefined="false">

  <TYPE_DEFS>

    <TYPE_DEF name="DiagnosticType" type="INTEGER" bitLength="5" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="0-No diagnostic" value="0" />
        <VAL_ENUM uiShowName="1-Control Detection Time Expired" value="1" />
        <VAL_ENUM uiShowName="2-Echo Function Failed" value="2" />
        <VAL_ENUM uiShowName="3-Neighbor Signalled Session Down" value="3" />
        <VAL_ENUM uiShowName="4-Forwarding Plane Reset" value="4" />
        <VAL_ENUM uiShowName="5-Path Down" value="5" />
        <VAL_ENUM uiShowName="6-Concatenated Path Down" value="6" />
        <VAL_ENUM uiShowName="7-Administratively Down" value="7" />
        <VAL_ENUM uiShowName="8-Reverse Concatenated Path Down" value="8" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>
    
    <TYPE_DEF name="StateType" type="INTEGER" bitLength="2" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="0-AdminDown" value="0"/>
        <VAL_ENUM uiShowName="1-Down" value="1"/>
        <VAL_ENUM uiShowName="2-Init" value="2"/>
        <VAL_ENUM uiShowName="3-Up" value="3"/>
      </VALUE_ENUMERATION>
    </TYPE_DEF>
	
	<TYPE_DEF name="MD5AuthenticationType"  type ="INTEGER" bitLength="8" unitType="ELEMENT">
	   <VALUE_ENUMERATION>
	      <VAL_ENUM uiShowName="2-Keyed MD5" value="2"/>
		  <VAL_ENUM uiShowName="3-Meticulous Keyed MD5" value="3"/>
	   </VALUE_ENUMERATION>
	</TYPE_DEF>	  

    <TYPE_DEF name="Password" type="SEQUENCE" unitType="ELEMENT"
        uiShowName="Password" >
      <FIELD name="Password" type="ASCII" minByteLength="1" maxByteLength="4" defaultValue ="0" uiShowName="Password"/>
    </TYPE_DEF>

    <TYPE_DEF name="SimplePasswordList" type="SEQUENCE_OF" elementType="Password"
        minOccurs="1" maxOccurs="4" unitType="ELEMENT" />
    
    <TYPE_DEF name="HdrAuthPassword" type="SEQUENCE"
        unitType="ELEMENT" uiShowName="Simple Password" >
      <FIELD name="authType" type="INTEGER" bitLength="8"
          defaultValue="1"
          uiControlState="CALCULATED"
          uiShowName="Authentication Type" />
      <FIELD name="AuthLength" type="INTEGER" bitLength="8"
             defaultValue="3" uiControlState="CALCULATED" uiShowName="Authentication Length" uiShowCommon="false" procfnTarget="BFDSIMPLEAUTHLENGTH" />
      <FIELD name="AuthKeyId" type="INTEGER" bitLength="8" defaultValue="0" 
             uiShowName="Auth Key ID" uiShowCommon="false" />
      <FIELD name="simplePassword" type="SimplePasswordList"
          uiShowName="Simple Password" />
    </TYPE_DEF>

    <TYPE_DEF name="HdrAuthCrypto" type="SEQUENCE"
        unitType="ELEMENT" uiShowName="MD5" >
      <FIELD name="authType" type="MD5AuthenticationType" bitLength="8"
          defaultValue="2" uiShowName="Authentication Type" />
      <FIELD name="AuthLength" type="INTEGER" bitLength="8"
             defaultValue="24" uiControlState="CALCULATED" uiShowName="Authentication Length" uiShowCommon="false" />
      <FIELD name="AuthKeyId" type="INTEGER" bitLength="8" defaultValue="0" 
             uiShowName="Authentication Key ID" uiShowCommon="false" />
      <FIELD name="Res" type="INTEGER" bitLength="8" defaultValue="0" uiControlState="CALCULATED"
             uiShowCommon="false" uiShowName="Reserved" />
      <FIELD name="SeqNum" type="INTEGER" bitLength="32"
          defaultValue="0"
          uiShowName="Sequence Number" />
      <FIELD name="AuthKey1" type="INTEGER" bitLength="32"
          defaultValue="0"
          uiShowName="Authentication Key" />
      <FIELD name="AuthKey2" type="INTEGER" bitLength="32"
          defaultValue="0"
          uiShowName="Authentication Key" />
    </TYPE_DEF>




    <TYPE_DEF name="BfdHeader" type="SEQUENCE"
        unitType="ELEMENT" uiShowName="BFD Header" >

      <FIELD name="version" type="INTEGER" bitLength="3"
          defaultValue="1"
          uiShowName="Bfd Version"  uiShowCommon="false"/>

      <FIELD name="diagnostic" type="DiagnosticType"
          defaultValue="0"
          uiShowName="Diagnostic" uiShowCommon ="false"/>
          
      <FIELD name ="state" type ="StateType"  
             defaultValue="0" 
             uiShowName="State" />

      <FIELD name="P" type="BITSTRING" bitLength="1" defaultValue ="0" uiShowName="Poll" />
      
      <FIELD name="F" type="BITSTRING" bitLength="1" defaultValue="0" uiShowName="Final" />

      <FIELD name="C" type="BITSTRING" bitLength="1" defaultValue="0" uiShowName="Control Plane Independent" />

      <FIELD name="A" type="BITSTRING" bitLength="1" defaultValue="0" uiShowName="Authentication Present" />

      <FIELD name="D" type="BITSTRING" bitLength="1" defaultValue="0" uiShowName="Demand" />
      
      <FIELD name="M" type="BITSTRING" bitLength="1" defaultValue="0" uiShowName="Multipoint" />

      <FIELD name ="DTM" type="INTEGER" bitLength="8" defaultValue ="0" uiShowName="Detect Time Multipler" />

      <!-- Length needs to be auto calculated-->
      <FIELD name="Length" type="INTEGER" bitLength="8" defaultValue="0" uiShowName="Length" uiShowCommon="false" uiControlState="CALCULATED"
          procfnTarget="HDRLENGTH" />

      <FIELD name="MyDiscriminator" type="INTEGER" bitLength="32" defaultValue="0" uiShowName="My Discriminator"/>

      <FIELD name="YourDiscriminator" type="INTEGER" bitLength="32" defaultValue="0" uiShowName="Your Discriminator"/>

      <FIELD name="DesiredMinTxInterval" type="INTEGER" bitLength="32" uiShowName="Desired Min TX Interval" uiShowCommon="false"/>

      <FIELD name="ReqMinRxInterval" type="INTEGER" bitLength="32" uiShowName="Required Min RX Interval" uiShowCommon="false"/>

      <FIELD name="ReqMinEchoRxInterval" type="INTEGER" bitLength="32" uiShowName="Required Min Echo RX Interval" uiShowCommon="false"/>

    </TYPE_DEF>

    <TYPE_DEF name="BFD" type="SEQUENCE"
        unitType="MESSAGE" uiShowName="BFD" >

      <FIELD name="header" type="BfdHeader" uiNoShowModifier="Interface,Frame" uiShowName="Packet Header"/>

    </TYPE_DEF>

    <TYPE_DEF name="BFDSimpleAuth" type="SEQUENCE"
        unitType="HEADER" uiShowName="BFD With Authentication" >

      <FIELD name="header" type="BfdHeader" uiNoShowModifier="Interface,Frame" uiShowName="Packet Header"/>

      <FIELD name="auth" type="HdrAuthPassword" uiNoShowModifier="Interface,Frame"
          uiShowName="Authentication" />

    </TYPE_DEF>

    <TYPE_DEF name="BFDCryptoAuth" type="SEQUENCE"
        unitType="HEADER" uiShowName="BFD With Authentication" >

      <FIELD name="header" type="BfdHeader" uiNoShowModifier="Interface,Frame" uiShowName="Packet Header"/>

      <FIELD name="auth" type="HdrAuthCrypto" uiNoShowModifier="Interface,Frame"
          uiShowName="Authentication" />

    </TYPE_DEF>
  </TYPE_DEFS>
  
</PDU_LIBRARY>

