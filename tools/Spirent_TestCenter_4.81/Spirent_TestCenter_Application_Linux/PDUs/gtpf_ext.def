<?xml version="1.0" encoding="UTF-8"?>
<PDU_LIBRARY xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="pdu_schema.xsd"
    name="gtpf_ext"
    showName="GTPf_ext"
    version="1.00"
    description="This is a sample PDU library for GTPf as defined in XML Stream Editor.">

    <!-- ==============================================================================================
    = This template is used when Extended Header Flag is enabled.
    = The packet will include sequence number and N-PDU Number
    = event if Sequence Number Flag and N-PDU Number Flag are disabled.
    ==============================================================================================  -->

    <TYPE_DEFS>
        <TYPE_DEF name="GTPfOptExt" type="SEQUENCE" unitType="HEADER" portType="Ethernet" uiShowName="GTPf Optional Fields and Extension Header" >
            <FIELD name="seqno"        type="INTEGER"      bitLength="16"      defaultValue="0" uiShowName="Sequence Number" />
            <FIELD name="Npdu"         type="INTEGER"      bitLength="8"       defaultValue="0" uiShowName="N-PDU Number" />
            <FIELD name="curHdrType"   type="INTEGER"      bitLength="8"       defaultValue="0" uiShowName="Next Extension Header Type" />

            <FIELD name="mlength"      type="INTEGER"      bitLength="8"       defaultValue="1"  uiControlState="CALCULATED" binder="calculated" procfnTarget="HDRLENGTHBY4" uiShowName="Extension Header Total Length" />
            <FIELD name="pattern"      type="OCTETSTRING"  defaultValue="0000" uiShowName="Byte pattern" minByteLength="2" maxByteLength="1500" />
            <FIELD name="nxtHdrType"   type="INTEGER"      bitLength="8"        defaultValue="0" uiShowName="Next Extension Header Type" />

            <NEXT_HEADERS>
                <NXT_HDR id="custom:Custom" name="Custom" value="0" />
                <NXT_HDR id="customrepeat:CustomRepeat" name="CustomRepeat" value="00" />
                <NXT_HDR id="ipv4:IPv4" name="IPv4 Header" value="4" />
                <NXT_HDR id="ipv6:IPv6" name="IPv6 Header" value="41" />
                <NXT_HDR id="gtpf_ext:GTPfExtHdr" name="GTPf Extension Header" value="3387" />
            </NEXT_HEADERS>

        </TYPE_DEF>

        <TYPE_DEF name="GTPfExtHdr" type="SEQUENCE" unitType="HEADER" portType="Ethernet" uiShowName="GTPf Extension Header" >
            <FIELD name="mlength"     type="INTEGER"      bitLength="8"       defaultValue="1"  uiControlState="CALCULATED" binder="calculated" procfnTarget="HDRLENGTHBY4" uiShowName="Extension Header Total Length" />
            <FIELD name="pattern"     type="OCTETSTRING"  defaultValue="0000" uiShowName="Byte pattern" minByteLength="2" maxByteLength="1500" />
            <FIELD name="nxtHdrType"  type="INTEGER"      bitLength="8"       defaultValue="0" uiShowName="Next Extension Header Type" />

            <NEXT_HEADERS>
                <NXT_HDR id="custom:Custom" name="Custom" value="0" />
                <NXT_HDR id="customrepeat:CustomRepeat" name="CustomRepeat" value="00" />
                <NXT_HDR id="ipv4:IPv4" name="IPv4 Header" value="4" />
                <NXT_HDR id="ipv6:IPv6" name="IPv6 Header" value="41" />
                <NXT_HDR id="gtpf_ext:GTPfExtHdr"      name="GTPf Extension Header" value="3387" />
            </NEXT_HEADERS>
        </TYPE_DEF>

    </TYPE_DEFS>
</PDU_LIBRARY>

