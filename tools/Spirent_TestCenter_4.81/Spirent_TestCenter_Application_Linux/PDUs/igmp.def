<?xml version="1.0" encoding="UTF-8"?>
<PDU_LIBRARY xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="pdu_schema.xsd" name="igmp" showName="Igmp" version="1.00"
    description="This is a sample PDU library for Igmp as defined in XML Stream Editor.">

  <TYPE_DEFS>

    <TYPE_DEF name="Igmpv1MessageType" type="INTEGER" bitLength="4" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="v1 Query" value="1" />
        <VAL_ENUM uiShowName="v1 Report" value="2" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="Igmpv1" type="SEQUENCE" unitType="MESSAGE"
        level="3" uiShowName="Igmp v1 Message" >

      <FIELD name="version" type="INTEGER" bitLength="4"
          defaultValue="1" minValue="1" maxValue="1"
          uiShowName="Version" />

      <FIELD name="type" type="Igmpv1MessageType"
         defaultValue="2"
         uiShowName="Message Type" />

      <FIELD name="unused" type="INTEGER" bitLength="8"
         defaultValue="0"
		 uiShowCommon="false"
         uiShowName="Unused" />

      <FIELD name="checksum" type="INTEGER" bitLength="16"
         defaultValue="0"
         uiControlState="ALLOW_OVERRIDE" 
         procfnTarget="HDRCHECKSUM"
         uiNoShowModifier="Interface,Filter" 
         uiShowName="Checksum" />

      <FIELD name="groupAddress" type="IPV4ADDR"
         defaultValue="225.0.0.1" 
         uiShowName="Group Address" />

    </TYPE_DEF>

    <TYPE_DEF name="Igmpv2MessageType" type="OCTETSTRING" byteLength="1" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="Membership Query" value="11" />
        <VAL_ENUM uiShowName="Version 2 Membership Report" value="16" />
        <VAL_ENUM uiShowName="Leave Group" value="17" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="Igmpv2" type="SEQUENCE" unitType="MESSAGE"
        level="3" uiShowName="Igmp v2 Message" >

      <FIELD name="type" type="Igmpv2MessageType"
         defaultValue="16"
         uiShowName="Message Type" />

      <FIELD name="maxRespTime" type="INTEGER" bitLength="8"
         defaultValue="0"
         uiShowName="Maximum Response Time" />

      <FIELD name="checksum" type="INTEGER" bitLength="16"
         defaultValue="0"
         uiControlState="ALLOW_OVERRIDE" 
         procfnTarget="HDRCHECKSUM"
         uiNoShowModifier="Interface,Filter"
         uiShowName="Checksum" />

      <FIELD name="groupAddress" type="IPV4ADDR"
         defaultValue="225.0.0.1" 
         uiShowName="Group Address" />

    </TYPE_DEF>

    <TYPE_DEF name="Igmpv2ReportMessageType" type="OCTETSTRING" byteLength="1" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="Version 2 Membership Report" value="16" />
        <VAL_ENUM uiShowName="Leave Group" value="17" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="Igmpv2Report" type="SEQUENCE" unitType="MESSAGE"
        level="3" uiShowName="Igmpv2 Report Message" >

      <FIELD name="type" type="Igmpv2ReportMessageType"
         defaultValue="16"
         uiShowName="Message Type" />

      <FIELD name="maxRespTime" type="INTEGER" bitLength="8"
         defaultValue="0"
         uiShowName="Maximum Response Time" />

      <FIELD name="checksum" type="INTEGER" bitLength="16"
         defaultValue="0"
         uiControlState="ALLOW_OVERRIDE" 
         procfnTarget="HDRCHECKSUM"
         uiNoShowModifier="Interface,Filter"
         uiShowName="Checksum" />

      <FIELD name="groupAddress" type="IPV4ADDR"
         defaultValue="225.0.0.1" 
         uiShowName="Group Address" />

    </TYPE_DEF>
    
    <TYPE_DEF name="Igmpv2Query" type="SEQUENCE" unitType="MESSAGE"
        level="3" uiShowName="Igmpv2 Query Message" >

      <FIELD name="type" type="OCTETSTRING" byteLength="1"
         defaultValue="11"
         uiShowName="Message Type" />

      <FIELD name="maxRespTime" type="INTEGER" bitLength="8"
         defaultValue="100"
         uiShowName="Maximum Response Time" />

      <FIELD name="checksum" type="INTEGER" bitLength="16"
         defaultValue="0"
         uiControlState="ALLOW_OVERRIDE" 
         procfnTarget="HDRCHECKSUM"
         uiNoShowModifier="Interface,Filter"
         uiShowName="Checksum" />

      <FIELD name="groupAddress" type="IPV4ADDR"
         defaultValue="225.0.0.1" 
         uiShowName="Group Address" />

    </TYPE_DEF>

    <TYPE_DEF name="Igmpv3MessageType" type="OCTETSTRING" byteLength="1" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="Membership Query" value="11" />
        <VAL_ENUM uiShowName="Version 3 Membership Report" value="22" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>

    <TYPE_DEF name="Ipv4Addr" type="SEQUENCE" unitType="ELEMENT" uiShowName="IPv4 Address" >
      <FIELD name="value" type="IPV4ADDR"
          defaultValue="192.0.0.1"
          uiShowName="Ipv4 Address" />
    </TYPE_DEF>

    <TYPE_DEF name="SourceList" type="SET_OF" elementType="Ipv4Addr" 
        minOccurs="0" maxOccurs="1000" unitType="ELEMENT" />

    <TYPE_DEF name="Igmpv3Query" type="SEQUENCE" unitType="MESSAGE"
        level="3" uiShowName="Igmpv3 Query Message" >

      <FIELD name="type" type="OCTETSTRING" byteLength="1"
         defaultValue="11"
         uiShowName="Message Type" />

      <FIELD name="maxRespTime" type="INTEGER" bitLength="8"
         defaultValue="100"
         uiShowName="Maximum Response Time" />

      <FIELD name="checksum" type="INTEGER" bitLength="16"
         defaultValue="0"
         uiControlState="ALLOW_OVERRIDE" 
         procfnTarget="HDRCHECKSUM"
         uiNoShowModifier="Interface,Filter"
         uiShowName="Checksum" />

      <FIELD name="groupAddress" type="IPV4ADDR"
         defaultValue="225.0.0.1" 
         uiShowName="Group Address" />

      <FIELD name="resv" type="INTEGER" bitLength="4"
         defaultValue="0"
		 uiShowCommon="false"
         uiShowName="Reserved" />

      <!-- Suppress Router-side processing -->
      <FIELD name="sFlag" type="BITSTRING" bitLength="1"
         defaultValue="1"
         uiShowName="Suppress Flag" />

      <!-- Querier's Robustness Variable -->
      <FIELD name="qrv" type="BITSTRING" bitLength="3"
         defaultValue="0"
		 uiShowCommon="false"
         uiShowName="QRV" />

      <!-- Querier's Query Interval Code -->
      <FIELD name="qqic" type="INTEGER" bitLength="8"
         defaultValue="0"
		 uiShowCommon="false"
         uiShowName="QQIC" />

      <FIELD name="numSource" type="INTEGER" bitLength="16"
         defaultValue="0"
         uiShowName="Number of Sources" />

      <FIELD name="addrList" type="SourceList"
          uiShowName="Source Address List"/>

    </TYPE_DEF>

    <TYPE_DEF name="Igmpv3RecordType" type="INTEGER" bitLength="8"  unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="MODE_IS_INCLUDE" value="1" />
        <VAL_ENUM uiShowName="MODE_IS_EXCLUDE" value="2" />
        <VAL_ENUM uiShowName="CHANGE_TO_INCLUDE_MODE" value="3" />
        <VAL_ENUM uiShowName="CHANGE_TO_EXCLUDE_MODE" value="4" />
        <VAL_ENUM uiShowName="ALLOW_NEW_SOURCES" value="5" />
        <VAL_ENUM uiShowName="BLOCK_OLD_SOURCES" value="6" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>


    <TYPE_DEF name="GroupRecord" type="SEQUENCE" unitType="ELEMENT" uiShowName="Igmpv3 Group Record" >
      <FIELD name="recordType" type="Igmpv3RecordType"
             uiShowName="Record Type" />
      <FIELD name="auxDataLen" type="INTEGER" bitLength="8"
             defaultValue="0"
             uiShowName="Auxiliary Data Length" />
      <FIELD name="numSource" type="INTEGER" bitLength="16"
             defaultValue="0"
             uiShowName="Number of Sources" />
      <FIELD name="mcastAddr" type="IPV4ADDR"
             defaultValue="225.0.0.1"
             uiShowName="Multicast Address" />
      <FIELD name="addrList" type="SourceList"
             uiShowName="Source Address List"/>
    </TYPE_DEF>

    <TYPE_DEF name="GroupRecordList" type="SET_OF" elementType="GroupRecord"
        minOccurs="0" maxOccurs="1000" unitType="ELEMENT" />


    <TYPE_DEF name="Igmpv3Report" type="SEQUENCE" unitType="MESSAGE"
        level="3" uiShowName="Igmpv3 Report Message" >

      <FIELD name="type" type="OCTETSTRING" byteLength="1"
         defaultValue="22"
         uiShowName="Message Type" />

      <FIELD name="reserved" type="INTEGER" bitLength="8"
         defaultValue="0"
         uiShowName="Reserved" />

      <FIELD name="checksum" type="INTEGER" bitLength="16"
         defaultValue="0"
         uiControlState="ALLOW_OVERRIDE" 
         procfnTarget="HDRCHECKSUM"
         uiNoShowModifier="Interface,Filter"
         uiShowName="Checksum" />

      <FIELD name="reserved2" type="INTEGER" bitLength="16"
         defaultValue="0"
         uiShowName="Reserved" />

      <FIELD name="numGrpRecords" type="INTEGER" bitLength="16"
         defaultValue="0"
         uiShowName="Number of Group Records" />

      <FIELD name="grpRecords" type="GroupRecordList"
         uiShowName="Group Records" />

    </TYPE_DEF>
    
  </TYPE_DEFS>
</PDU_LIBRARY>
