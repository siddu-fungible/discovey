<?xml version="1.0" encoding="UTF-8"?>
<PDU_LIBRARY xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="pdu_schema.xsd" name="lisp" showName="Lisp" version="1.00"
    description="This is a sample PDU library for Lisp as defined in XML Stream Editor.">
    
  <TYPE_DEFS>
        
    <TYPE_DEF name="LsbSelect" type="CHOICE" unitType="ELEMENT" uiShowName="Instance ID/LSB">
      <FIELD name="lsb32" type="LsbWithoutInstance" bitLength="32" uiShowName="Locator Status Bits without Instance ID" />
      <FIELD name="lsb8" type="LsbWithInstance" uiShowName="Locator Status Bits with Instance ID" />
    </TYPE_DEF> 
	
	<TYPE_DEF name="LsbWithInstance" type="SEQUENCE" unitType="ELEMENT" uiShowName="Locator Status Bits with Instance ID">
      <FIELD name="instanceId" type="INTEGER" bitLength="24" defaultValue="0" 			
	        uiNoShow="Interface"
			uiShowName="Instance ID" />
	  <FIELD name="lsb" type="OCTETSTRING" byteLength="1" defaultValue="00" 			
	        uiNoShow="Interface"
			uiShowName="Locator Status Bits" />
    </TYPE_DEF>
	<TYPE_DEF name="LsbWithoutInstance" type="SEQUENCE" unitType="ELEMENT" uiShowName="Locator Status Bits (32bits)">
	  <FIELD name="lsb" type="OCTETSTRING" byteLength="4" defaultValue="00000000" 			
	        uiNoShow="Interface"
			uiShowName="Locator Status Bits" />
    </TYPE_DEF>
	<TYPE_DEF name="NonceVersionSelect" type="CHOICE" unitType="ELEMENT" uiShowName="Nonce/Version">
      <FIELD name="nonce" type="NonceType" 	uiShowName="Nonce" />
      <FIELD name="mapVersion" type="MapVersionType" uiShowName="Map Version" />
    </TYPE_DEF> 
	<TYPE_DEF name="NonceType" type="SEQUENCE" unitType="ELEMENT" uiShowName="Nonce">
      <FIELD name="nonce" type="INTEGER" bitLength="24" defaultValue="0" 			
	        uiNoShow="Interface"
			uiShowName="Nonce" />	  
    </TYPE_DEF>
	
	<TYPE_DEF name="MapVersionType" type="SEQUENCE" unitType="ELEMENT" uiShowName="Map Version">
      <FIELD name="srcMapVersion" type="INTEGER" bitLength="12" defaultValue="0" 			
	        uiNoShow="Interface"
			uiShowName="Source Map Version" />
	  <FIELD name="destMapVersion" type="INTEGER" bitLength="12" defaultValue="0" 			
	        uiNoShow="Interface"
			uiShowName="Destination Map Version" />
    </TYPE_DEF>
	
	<TYPE_DEF name="Lisp" type="SEQUENCE" unitType="HEADER"
			level="3" uiShowName="Lisp Header" niMapped="true">
        
		<FIELD name="nBit" type="BITSTRING" bitLength="1" 
			defaultValue="0"
			uiControlState="ALLOW_OVERRIDE" 
			uiNoShow="Interface"
			uiNoShowModifier="Interface,Frame,Filter"
			uiShowName="N Bit" />

		<FIELD name="lBit" type="BITSTRING" bitLength="1"
            uiControlState="ALLOW_OVERRIDE" 
			defaultValue="0"
			uiNoShow="Interface"
			uiNoShowModifier="Interface,Frame,Filter"
			uiShowName="L Bit" />
		
		<FIELD name="eBit" type="BITSTRING" bitLength="1"
			uiControlState="ALLOW_OVERRIDE" 
			defaultValue="0"
			uiNoShow="Interface"
			uiNoShowModifier="Interface,Frame,Filter"
			uiShowName="E Bit" />
		
		<FIELD name="vBit" type="BITSTRING" bitLength="1"
			uiControlState="ALLOW_OVERRIDE" 
			defaultValue="0"
			uiNoShow="Interface"
			uiNoShowModifier="Interface,Frame,Filter"
			uiShowName="V Bit" />
		
		<FIELD name="iBit" type="BITSTRING" bitLength="1"
			uiControlState="ALLOW_OVERRIDE" 
			defaultValue="0"
			uiNoShow="Interface"
			uiNoShowModifier="Interface,Frame,Filter"
			uiShowName="I Bit" />
			
		<FIELD name="flags" type="BITSTRING" bitLength="3"
			uiControlState="ALLOW_OVERRIDE" 
			defaultValue="000"
			uiNoShow="Interface"
			uiNoShowModifier="Frame,Interface,Filter"
			uiShowName="flags" />
		
		<FIELD name="nonceOrVersion" type="NonceVersionSelect" 
		    defaultValue="nonce"
			uiNoShow="Interface"
			uiShowName="Nonce/Version" />
				
		<FIELD name="lsb" type="LsbSelect" 
		    defaultValue="lsb32"
			uiNoShow="Interface"
			uiShowName="Instance ID/LSB" />
							
		<NEXT_HEADERS>
			<NXT_HDR id="ipv4:IPv4" name="IPv4 Header" value="4" />
			<NXT_HDR id="ipv6:IPv6" name="IPv6 Header" value="41" />
		</NEXT_HEADERS>
	</TYPE_DEF>
	
	<TYPE_DEF name="LispControlEncapsulatHeader" type="SEQUENCE" unitType="HEADER"
			level="3" uiShowName="Lisp Control Message Encapsulate Header" >
        <FIELD name="type" type="INTEGER" bitLength="4" 
				defaultValue="8"
				uiControlState="CALCULATED" 
				uiNoShow="Interface"
				uiNoShowModifier="Interface,Frame,Filter"
				uiShowName="Type" />

		<FIELD name="reserved" type="INTEGER" bitLength="28"
				uiControlState="ALLOW_OVERRIDE" 
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Frame,Interface,Filter"
				uiShowName="Reserved" />		
							
		<NEXT_HEADERS>
			<NXT_HDR id="ipv4:IPv4" name="IPv4 Header" value="4" />
			<NXT_HDR id="ipv6:IPv6" name="IPv6 Header" value="41" />
		</NEXT_HEADERS>
	</TYPE_DEF> 	
		
	<TYPE_DEF name="LocatorList" type="SEQUENCE_OF" minOccurs="1" maxOccurs="32" elementType="Locator" uiShowName="Address List" unitType="ELEMENT"></TYPE_DEF>
	<TYPE_DEF name="Locator" type="SEQUENCE" uiShowName="Address Choice" unitType="ELEMENT" >
		<FIELD name="addr" type="LocatorAddrChoice" defaultValue="ipv4Addr" uiShowName="Address" />
	</TYPE_DEF>
	
	<TYPE_DEF name="LocatorAddrChoice" type="CHOICE" uiShowName="Address Choice" unitType="ELEMENT" >
		<FIELD name="ipv4Addr" type="IPv4AddrType" uiShowName="IPv4 Address" />
		<FIELD name="ipv6Addr" type="IPv6AddrType" uiShowName="IPv6 Address" />
	</TYPE_DEF>
    <TYPE_DEF name="EidAddrChoice" type="CHOICE" uiShowName="Address Choice" unitType="ELEMENT" >
		<FIELD name="ipv4Addr" type="IPv4AddrType" uiShowName="IPv4 Address" />
		<FIELD name="ipv6Addr" type="IPv6AddrType" uiShowName="IPv6 Address" />
		<FIELD name="noEidAddr" type="NoAddrType" uiShowName="No EID Address" />
	</TYPE_DEF>
	<TYPE_DEF name="IPv4AddrType" type="SEQUENCE" unitType="ELEMENT" uiShowName="IPv4 Address" >
		<FIELD name="addrFamily" type="INTEGER" bitLength="16" uiShowName="Address Family" defaultValue="1" uiControlState="CALCULATED"  />
		<FIELD name="addr" type="IPV4ADDR" defaultValue="10.10.10.1" uiShowName="IPv4 Address" />
	</TYPE_DEF>
	<TYPE_DEF name="IPv6AddrType" type="SEQUENCE" unitType="ELEMENT" uiShowName="IPv6 Address" >
		<FIELD name="addrFamily" type="INTEGER" bitLength="16" uiShowName="Address Family" defaultValue="2" uiControlState="CALCULATED"  />
		<FIELD name="addr" type="IPV6ADDR" defaultValue="2000::1" uiShowName="IPv6 Address" />
	</TYPE_DEF>
	<TYPE_DEF name="NoAddrType" type="SEQUENCE" unitType="ELEMENT" uiShowName="No Address" >
		<FIELD name="addrFamily" type="INTEGER" bitLength="16" uiShowName="Address Family" defaultValue="0" uiControlState="CALCULATED"  />
	</TYPE_DEF>
	<TYPE_DEF name="RequestRecordsList" type="SEQUENCE_OF" elementType="RequestRecord" minOccurs="0" maxOccurs="32" uiShowName="Record List" unitType="ELEMENT"> </TYPE_DEF>
	<TYPE_DEF name="RequestRecord" type="SEQUENCE" uiShowName="Request Record" unitType="ELEMENT">
		<FIELD name="record" type="RecordChoice" defaultValue="ipv4Record" uiShowName="Record Type" />
	</TYPE_DEF>
	<TYPE_DEF name="RecordChoice" type="CHOICE" uiShowName="Record Choice" unitType="ELEMENT" >
		<FIELD name="ipv4Record" type="Ipv4Record" uiShowName="IPv4 Record" />
		<FIELD name="ipv6Record" type="Ipv6Record" uiShowName="IPv6 Record" />
	</TYPE_DEF>
	<TYPE_DEF name="Ipv4Record" type="SEQUENCE" uiShowName="IPv4 Record" unitType="ELEMENT" >
		<FIELD name="reserved" type="OCTETSTRING" byteLength="1" defaultValue="0" uiShowName="Reserved" />
		<FIELD name="eidMaskLen" type="INTEGER" bitLength="8" defaultValue="32" minValue="0" maxValue="32" uiShowName="EID Mask Length" />
		<FIELD name="eidAddrFamily" type="INTEGER" bitLength="16" uiShowName="EID Address Family" defaultValue="1" uiControlState="CALCULATED"  />
		<FIELD name="eidAddr" type="IPV4ADDR" defaultValue="10.10.10.1" uiShowName="EID Address" />
	</TYPE_DEF>
	<TYPE_DEF name="Ipv6Record" type="SEQUENCE" uiShowName="IPv6 Record" unitType="ELEMENT" >
		<FIELD name="reserved" type="OCTETSTRING" byteLength="1" defaultValue="0" uiShowName="Reserved" />
		<FIELD name="eidMaskLen" type="INTEGER" bitLength="8" defaultValue="128" minValue="0" maxValue="128" uiShowName="EID Mask Length" />
		<FIELD name="eidAddrFamily" type="INTEGER" bitLength="16" uiShowName="EID Address Family" defaultValue="2" uiControlState="CALCULATED"  />
		<FIELD name="eidAddr" type="IPV6ADDR" defaultValue="2000::1" uiShowName="EID Address" />
	</TYPE_DEF>

		
	<TYPE_DEF name="LispMapRequest" type="SEQUENCE" unitType="HEADER" level="3" uiShowName="Lisp Map Request">
        
			<FIELD name="type" type="INTEGER" bitLength="4" 
				defaultValue="1"
				uiControlState="CALCULATED" 
				uiNoShow="Interface"
				uiNoShowModifier="Interface,Frame,Filter"
				uiShowName="Type" />

			<FIELD name="aBit" type="BITSTRING" bitLength="1"
				uiControlState="ALLOW_OVERRIDE" 
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Interface,Frame,Filter"
				uiShowName="A Bit" />
			
			<FIELD name="mBit" type="BITSTRING" bitLength="1"
				uiControlState="ALLOW_OVERRIDE" 
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Interface,Frame,Filter"
				uiShowName="M Bit" />
			
			<FIELD name="pBit" type="BITSTRING" bitLength="1"
				uiControlState="ALLOW_OVERRIDE" 
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Interface,Frame,Filter"
				uiShowName="P Bit" />
			
			<FIELD name="sBit" type="BITSTRING" bitLength="1"
				uiControlState="ALLOW_OVERRIDE" 
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Interface,Frame,Filter"
				uiShowName="S Bit" />
				
			<FIELD name="reserved" type="INTEGER" bitLength="11"
				uiControlState="ALLOW_OVERRIDE" 
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Frame,Interface,Filter"
				uiShowName="Reserved" />
			
			<FIELD name="itrCount" type="INTEGER" bitLength="5"
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Frame,Interface,Filter"
				uiShowName="ITR Count" 
				procfnTarget="LISPRECORDCOUNT"
				uiControlState="ALLOW_OVERRIDE"/>
			
			<FIELD name="recordCount" type="INTEGER" bitLength="8"
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Frame,Interface,Filter"
				uiShowName="Record Count" 
				procfnTarget="LISPRECORDCOUNT"
				uiControlState="ALLOW_OVERRIDE"/>
			
			<FIELD name="nonce" type="OCTETSTRING" byteLength="8"
				defaultValue="0000000000000000"
				uiNoShow="Interface"
				uiShowName="Nonce" />
				
			<FIELD name="srcEid" type="lisp:EidAddrChoice"
				uiNoShow="Interface" defaultValue="ipv4Addr"
				uiShowName="Source EID" />
			
			<FIELD name="itrRloc" type="lisp:LocatorList"
				uiNoShow="Interface"
				uiShowName="ITR Routing Locators" />
			
			<FIELD name="records" type="RequestRecordsList"
				uiNoShow="Interface"
				uiShowName="Map Request Records" />
			<FIELD name="replyRecord" type="ReplyRecordList"
				uiNoShow="Interface"
				uiShowName="Reply Records" />
			<FIELD name="optionalFields" type="OptionalFieldsList"
				uiNoShow="Interface"
				uiShowName="Optional Fields" />
			
			
								
	
    </TYPE_DEF> 
	<TYPE_DEF name="EnumAction" type="INTEGER" bitLength="3" unitType="ELEMENT">
      <VALUE_ENUMERATION>
        <VAL_ENUM uiShowName="No-Action" value="0" />
        <VAL_ENUM uiShowName="Natively-Forward" value="1" />
        <VAL_ENUM uiShowName="Send-Map-Request" value="2" />
        <VAL_ENUM uiShowName="Drop" value="3" />
      </VALUE_ENUMERATION>
    </TYPE_DEF>
	<TYPE_DEF name="ReplyRecordsList" type="SEQUENCE_OF" minOccurs="0" maxOccurs="30" elementType="ReplyRecord" unitType="ELEMENT"> </TYPE_DEF>
	<TYPE_DEF name="ReplyRecordList" type="SEQUENCE_OF" minOccurs="0" maxOccurs="1" elementType="ReplyRecord" unitType="ELEMENT"> </TYPE_DEF>
	<TYPE_DEF name="ReplyRecord" type="SEQUENCE" unitType="ELEMENT" uiShowName="Reply Record">
		<FIELD name="recordTtl" type="INTEGER" bitLength="32" uiNoShow="Interface" defaultValue="1440" uiShowName="Record TTL" />
		<FIELD name="locatorCount" type="INTEGER" bitLength="8" uiNoShow="Interface" defaultValue="0" uiShowName="Locator Count" procfnTarget="LISPRECORDCOUNT" uiControlState="ALLOW_OVERRIDE" />
		<FIELD name="eidMaskLength" type="INTEGER" bitLength="8" uiNoShow="Interface" defaultValue="32" uiShowName="EID Mask Length" />
		<FIELD name="action" type="EnumAction" bitLength="3" uiNoShow="Interface" defaultValue="3" uiShowName="Action" />
		<FIELD name="aBit" type="BITSTRING" bitLength="1" uiNoShow="Interface" defaultValue="1" uiShowName="A Bit" uiControlState="ALLOW_OVERRIDE"  />
		<FIELD name="reserved" type="INTEGER" bitLength="16" uiNoShow="Interface" defaultValue="0" uiShowName="Reserved" uiControlState="ALLOW_OVERRIDE"  />
		<FIELD name="mapVersion" type="INTEGER" bitLength="12" uiNoShow="Interface" defaultValue="0" uiShowName="Map Version" />
		<FIELD name="eidAddr" type="LocatorAddrChoice" uiNoShow="Interface" defaultValue="ipv4Addr" uiShowName="EID Address" />
		<FIELD name="locators" type="LocatorsList" uiNoShow="Interface" uiShowName="Locators" />		
	</TYPE_DEF>	
	<TYPE_DEF name="LocatorsList" type="SEQUENCE_OF" minOccurs="0" maxOccurs="10" elementType="LocatorInformation" unitType="ELEMENT"> </TYPE_DEF>
	<TYPE_DEF name="LocatorInformation" type="SEQUENCE" unitType="ELEMENT" uiShowName="Locator Information">
		<FIELD name="priority" type="INTEGER" bitLength="8" uiNoShow="Interface" defaultValue="0" uiShowName="Priority" />
		<FIELD name="weight" type="INTEGER" bitLength="8" uiNoShow="Interface" defaultValue="0" uiShowName="Weight" />
		<FIELD name="mPriority" type="INTEGER" bitLength="8" uiNoShow="Interface" defaultValue="0" uiShowName="Multicast Priority" />
		<FIELD name="mWeight" type="INTEGER" bitLength="8" uiNoShow="Interface" defaultValue="0" uiShowName="Multicast Weight" />
		<FIELD name="flags" type="INTEGER" bitLength="13" uiNoShow="Interface" defaultValue="0" uiShowName="Flags" uiControlState="ALLOW_OVERRIDE"  />
		<FIELD name="lBit" type="BITSTRING" bitLength="1" uiNoShow="Interface" defaultValue="0" uiShowName="L Bit" />
		<FIELD name="pBit" type="BITSTRING" bitLength="1" uiNoShow="Interface" defaultValue="0" uiShowName="P Bit" />
		<FIELD name="rBit" type="BITSTRING" bitLength="1" uiNoShow="Interface" defaultValue="0" uiShowName="R Bit" />
		<FIELD name="locatorAddr" type="LocatorAddrChoice" uiNoShow="Interface" defaultValue="ipv4Addr" uiShowName="Locator Address" />
	</TYPE_DEF>
	<TYPE_DEF name="OptionalFieldsList" type="SEQUENCE_OF" minOccurs="0" maxOccurs="1" elementType="OptionalField" unitType="ELEMENT"> </TYPE_DEF>
	<TYPE_DEF name="OptionalField" type="SEQUENCE" unitType="ELEMENT" uiShowName="Lisp Request Optional Field">
		<FIELD name="mappingProtocolData" type="OCTETSTRING" byteLength="4" defaultValue="00000000" uiNoShow="Interface" uiShowName="Mapping Protocol Data" />	
	</TYPE_DEF>	
	
	<TYPE_DEF name="LispMapReply" type="SEQUENCE" unitType="HEADER" level="3" uiShowName="Lisp Map Reply">
        
			<FIELD name="type" type="INTEGER" bitLength="4" 
				defaultValue="2"
				uiControlState="CALCULATED" 
				uiNoShow="Interface"
				uiNoShowModifier="Interface,Frame,Filter"
				uiShowName="Type" />

			<FIELD name="pBit" type="BITSTRING" bitLength="1"
				uiControlState="ALLOW_OVERRIDE" 
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Interface,Frame,Filter"
				uiShowName="P Bit" />
			
			<FIELD name="eBit" type="BITSTRING" bitLength="1"
				uiControlState="ALLOW_OVERRIDE" 
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Interface,Frame,Filter"
				uiShowName="E Bit" />
			
				
			<FIELD name="reserved" type="INTEGER" bitLength="18"
				uiControlState="ALLOW_OVERRIDE" 
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Frame,Interface,Filter"
				uiShowName="Reserved" />
			
			<FIELD name="recordCount" type="INTEGER" bitLength="8"
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Frame,Interface,Filter"
				uiShowName="Record Count"
				procfnTarget="LISPRECORDCOUNT"
				uiControlState="ALLOW_OVERRIDE" />			
		
			<FIELD name="nonce" type="OCTETSTRING" byteLength="8"
				defaultValue="0000000000000000"
				uiNoShow="Interface"
				uiShowName="Nonce" />
			<FIELD name="records" type="ReplyRecordsList" 
				uiNoShow="Interface"
				uiShowName="Records List" />			
			
			<FIELD name="optionalFields" type="OptionalFieldsList"
				uiNoShow="Interface"
				uiShowName="Optional Fields" />
										
	
    </TYPE_DEF> 
	<TYPE_DEF name="LispMapRegister" type="SEQUENCE" unitType="HEADER" level="3" uiShowName="Lisp Map Register">
        
			<FIELD name="type" type="INTEGER" bitLength="4" 
				defaultValue="3"
				uiControlState="CALCULATED" 
				uiNoShow="Interface"
				uiNoShowModifier="Interface,Frame,Filter"
				uiShowName="Type" />

			<FIELD name="pBit" type="BITSTRING" bitLength="1"
				uiControlState="ALLOW_OVERRIDE" 
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Interface,Frame,Filter"
				uiShowName="P Bit" />
			
			<FIELD name="reserved" type="INTEGER" bitLength="19"
				uiControlState="ALLOW_OVERRIDE" 
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Frame,Interface,Filter"
				uiShowName="Reserved" />
			
			<FIELD name="recordCount" type="INTEGER" bitLength="8"
				defaultValue="0"
				uiNoShow="Interface"
				uiNoShowModifier="Frame,Interface,Filter"
				uiShowName="Record Count" 
			    procfnTarget="LISPRECORDCOUNT"
				uiControlState="ALLOW_OVERRIDE"/>			
		
			<FIELD name="nonce" type="OCTETSTRING" byteLength="8"
				defaultValue="0000000000000000"
				uiNoShow="Interface"
				uiShowName="Nonce" />
			<FIELD name="keyId" type="OCTETSTRING" byteLength="2"
				defaultValue="0001" 
				uiNoShow="Interface"
				uiShowName="Key ID" />
			<FIELD name="authenticationDataLength" type="INTEGER" bitLength="16"
				defaultValue="20" uiControlState="CALCULATED"
				uiNoShow="Interface"
				uiShowName="Authentication Data Length" />
			<FIELD name="authenticationData" type="OCTETSTRING" byteLength="20"
				defaultValue="0000000000000000000000000000000000000000"
				uiNoShow="Interface"
				uiShowName="Authentication Data" 
			    procfnTarget="LISPSHA1"
				uiControlState="ALLOW_OVERRIDE"/>
			<FIELD name="records" type="ReplyRecordsList" 
				uiNoShow="Interface"
				uiShowName="Records List" />
			<FIELD name="sharedKey" type="ASCII" maxByteLength="64"
				defaultValue="0"
				uiNoShow="Interface" 
				uiShowName="Shared Key" 
			    doNotBuild ="true" />											
	
    </TYPE_DEF> 

  </TYPE_DEFS>
</PDU_LIBRARY>
